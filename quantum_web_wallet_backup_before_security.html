<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QRC Wallet - Quantum Resistant Blockchain</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%2300ff88' rx='20'/></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%); color: #ffffff; min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        
        /* Login Screen Styles */
        .login-container { 
            width: 100%; 
            max-width: 400px; 
            background: rgba(255, 255, 255, 0.05); 
            padding: 40px; 
            border-radius: 24px; 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            margin-top: 100px;
        }
        .login-logo { text-align: center; margin-bottom: 30px; }
        .login-logo .logo { width: 80px; height: 80px; background: #00ff88; border-radius: 20px; display: inline-flex; align-items: center; justify-content: center; font-size: 36px; font-weight: bold; color: #000; margin-bottom: 20px; }
        .login-title { font-size: 24px; text-align: center; margin-bottom: 10px; }
        .login-subtitle { color: #999; text-align: center; margin-bottom: 30px; }
        .input-group { margin-bottom: 20px; }
        .input-label { display: block; margin-bottom: 8px; color: #999; font-size: 14px; }
        .input-field { width: 100%; padding: 15px; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px; transition: all 0.3s; }
        .input-field:focus { outline: none; border-color: #00ff88; background: rgba(255, 255, 255, 0.08); }
        .password-toggle { position: relative; }
        .password-toggle-btn { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #999; cursor: pointer; font-size: 20px; }
        .error-message { background: rgba(255, 107, 107, 0.1); border: 1px solid #ff6b6b; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; display: none; }
        .success-message { background: rgba(0, 255, 136, 0.1); border: 1px solid #00ff88; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; display: none; }
        
        /* Main App Styles */
        .app-container { width: 100%; display: none; }
        .main-header { width: 100%; max-width: 1200px; display: flex; justify-content: space-between; align-items: center; margin: 0 auto 40px; padding: 20px 0; }
        .logo-section { display: flex; align-items: center; gap: 15px; }
        .logo { width: 50px; height: 50px; background: #00ff88; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #000; }
        .logo-text { font-size: 24px; font-weight: 700; }
        .nav-links { display: flex; gap: 30px; align-items: center; }
        .nav-link { color: #999; text-decoration: none; transition: color 0.3s; font-size: 14px; cursor: pointer; }
        .nav-link:hover { color: #00ff88; }
        .user-menu { display: flex; align-items: center; gap: 20px; }
        .user-info { display: flex; align-items: center; gap: 10px; padding: 8px 16px; background: rgba(255, 255, 255, 0.05); border-radius: 20px; }
        .user-avatar { width: 32px; height: 32px; background: #00ff88; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #000; }
        .logout-btn { background: none; border: 1px solid #ff6b6b; color: #ff6b6b; padding: 8px 16px; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .logout-btn:hover { background: #ff6b6b; color: white; }
        .network-indicator { display: flex; align-items: center; gap: 8px; background: rgba(0, 255, 136, 0.1); padding: 8px 16px; border-radius: 20px; font-size: 12px; }
        .network-dot { width: 8px; height: 8px; background: #00ff88; border-radius: 50%; animation: pulse 2s infinite; }
        .main-content { width: 100%; max-width: 1200px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin: 0 auto 40px; }
        .stats-section { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .stat-card { background: rgba(255, 255, 255, 0.05); padding: 24px; border-radius: 16px; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); transition: all 0.3s ease; }
        .stat-card:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.08); }
        .stat-value { font-size: 32px; font-weight: 700; color: #00ff88; margin-bottom: 5px; }
        .stat-label { font-size: 12px; color: #999; text-transform: uppercase; letter-spacing: 1px; }
        .wallet-section { background: rgba(255, 255, 255, 0.05); padding: 40px; border-radius: 24px; backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3); }
        .wallet-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .wallet-title { font-size: 20px; font-weight: 600; }
        .wallet-menu { display: flex; gap: 10px; }
        .menu-button { background: none; border: none; color: #999; cursor: pointer; padding: 8px; transition: color 0.3s; }
        .menu-button:hover { color: #00ff88; }
        .security-status { display: flex; align-items: center; gap: 10px; background: rgba(0, 255, 136, 0.1); padding: 8px 16px; border-radius: 20px; margin-bottom: 20px; }
        .security-icon { color: #00ff88; }
        .algorithm-badge { display: inline-flex; align-items: center; gap: 8px; background: rgba(0, 255, 136, 0.1); padding: 6px 12px; border-radius: 20px; font-size: 12px; color: #00ff88; margin-bottom: 20px; }
        .algorithm-badge .badge-icon { width: 16px; height: 16px; background: #00ff88; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #000; font-weight: bold; }
        .wallet-display { background: rgba(0, 0, 0, 0.3); padding: 24px; border-radius: 16px; margin-bottom: 30px; }
        .wallet-address-container { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .wallet-label { font-size: 12px; color: #999; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .wallet-address { font-family: 'Courier New', monospace; font-size: 14px; word-break: break-all; cursor: pointer; transition: color 0.3s; }
        .wallet-address:hover { color: #00ff88; }
        .address-actions { display: flex; gap: 10px; }
        .balance-display { text-align: center; padding: 30px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 30px; }
        .balance-label { font-size: 14px; color: #999; margin-bottom: 10px; }
        .balance-amount { font-size: 48px; font-weight: 700; background: linear-gradient(45deg, #00ff88, #00ffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 5px; }
        .balance-usd { font-size: 18px; color: #999; }
        .button { width: 100%; padding: 16px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .button-primary { background: linear-gradient(45deg, #00ff88, #00cc77); color: #000; }
        .button-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0, 255, 136, 0.3); }
        .button-secondary { background: transparent; color: #00ff88; border: 2px solid #00ff88; }
        .button-secondary:hover { background: #00ff88; color: #000; }
        .tabs { display: flex; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 30px; }
        .tab { padding: 12px 24px; cursor: pointer; color: #999; transition: all 0.3s; border-bottom: 2px solid transparent; }
        .tab.active { color: #00ff88; border-bottom-color: #00ff88; }
        .tab:hover { color: #00ff88; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .transaction-item { background: rgba(255, 255, 255, 0.05); padding: 16px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; transition: all 0.3s; animation: fadeIn 0.3s ease-out; }
        .transaction-item:hover { background: rgba(255, 255, 255, 0.08); }
        .transaction-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; margin-right: 15px; }
        .transaction-icon.received { background: rgba(0, 255, 136, 0.1); color: #00ff88; }
        .transaction-icon.sent { background: rgba(255, 107, 107, 0.1); color: #ff6b6b; }
        .transaction-details { flex: 1; }
        .transaction-type { font-weight: 600; margin-bottom: 4px; }
        .transaction-address { font-size: 12px; color: #999; font-family: monospace; }
        .transaction-time { font-size: 11px; color: #666; margin-top: 4px; }
        .transaction-amount { text-align: right; }
        .transaction-value { font-weight: 600; font-size: 16px; }
        .transaction-value.positive { color: #00ff88; }
        .transaction-value.negative { color: #ff6b6b; }
        .transaction-usd { font-size: 12px; color: #999; }
        .empty-state { text-align: center; padding: 60px 20px; color: #999; }
        .empty-state-icon { font-size: 48px; margin-bottom: 20px; opacity: 0.5; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal-content { background: #1a1a3e; padding: 40px; border-radius: 24px; max-width: 500px; width: 100%; max-height: 90vh; overflow-y: auto; animation: fadeIn 0.3s ease-out; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .modal-title { font-size: 24px; font-weight: 600; }
        .close-modal { background: none; border: none; color: #999; font-size: 24px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s; }
        .close-modal:hover { background: rgba(255, 255, 255, 0.1); color: #fff; }
        .qr-container { background: #fff; padding: 30px; border-radius: 16px; text-align: center; }
        .qr-title { color: #000; font-size: 18px; margin-bottom: 20px; }
        #qrcode, #receiveQrcode { margin: 0 auto 20px; display: inline-block; }
        .qr-address { background: #f5f5f5; padding: 12px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 12px; color: #000; word-break: break-all; margin-bottom: 20px; }
        .notification { position: fixed; bottom: 20px; right: 20px; background: #00ff88; color: #000; padding: 16px 24px; border-radius: 12px; font-weight: 600; animation: slideIn 0.3s ease-out; display: none; z-index: 2000; max-width: 400px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); }
        .notification.error { background: #ff6b6b; color: #fff; }
        .notification.warning { background: #ffa500; color: #000; }
        .notification.info { background: #3498db; color: #fff; }
        .notification.success { background: #00ff88; color: #000; }
        
        /* Wallet Connect Buttons */
        .wallet-connect-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }
        .wallet-connect-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #00ff88;
            transform: translateY(-2px);
        }
        .wallet-connect-btn img {
            width: 24px;
            height: 24px;
            object-fit: contain;
        }
        .seed-input {
            width: 100%;
            font-family: monospace;
            font-size: 14px;
            transition: all 0.3s;
        }
        .seed-input:focus {
            border-color: #00ff88 !important;
            outline: none;
        }
        .seed-input:valid {
            border-color: rgba(0, 255, 136, 0.3) !important;
        }
        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
        }
        .connection-status.error {
            background: rgba(255, 107, 107, 0.1);
            color: #ff6b6b;
        }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.2); opacity: 0.8; } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(100px); } to { opacity: 1; transform: translateX(0); } }
        
        @media (max-width: 968px) { 
            .main-content { grid-template-columns: 1fr; } 
            .main-header { flex-direction: column; gap: 20px; }
            .nav-links { flex-wrap: wrap; justify-content: center; }
        }
        @media (max-width: 768px) { 
            .stats-section { grid-template-columns: 1fr; } 
            .wallet-section { padding: 24px; } 
            .balance-amount { font-size: 36px; }
            .transaction-item { flex-direction: column; align-items: flex-start; gap: 10px; }
            .transaction-amount { align-self: flex-end; }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="login-logo">
            <div class="logo">QRC</div>
        </div>
        <h1 class="login-title">Quantum Wallet</h1>
        <p class="login-subtitle">Secure access to your quantum-resistant blockchain</p>
        
        <div class="error-message" id="loginError"></div>
        <div class="success-message" id="loginSuccess"></div>
        
        <div id="loginForm">
            <div class="input-group">
                <label class="input-label">Wallet Password</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="walletPassword" placeholder="Enter your secure password">
                    <button class="password-toggle-btn" onclick="togglePassword()">🔒</button>
                </div>
            </div>
            
            <button class="button button-primary" onclick="attemptLogin()">
                <span>🔐</span>
                <span>Unlock Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="showCreateNewWallet()">
                <span>✨</span>
                <span>Create New Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="showImportWallet()">
                <span>📥</span>
                <span>Import Existing Wallet</span>
            </button>
        </div>
        
        <div id="createWalletForm" style="display: none;">
            <div class="input-group">
                <label class="input-label">Create Password (min 8 characters)</label>
                <input type="password" class="input-field" id="newPassword" placeholder="Create a strong password">
            </div>
            
            <div class="input-group">
                <label class="input-label">Confirm Password</label>
                <input type="password" class="input-field" id="confirmPassword" placeholder="Confirm your password">
            </div>
            
            <button class="button button-primary" onclick="createNewWallet()">
                <span>🚀</span>
                <span>Create Secure Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="backToLogin()">
                <span>←</span>
                <span>Back to Login</span>
            </button>
        </div>
        
        <div id="importWalletForm" style="display: none;">
            <div style="margin-bottom: 20px;">
                <p style="color: #999; text-align: center; margin-bottom: 20px;">Connect your existing wallet</p>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px;">
                    <button class="wallet-connect-btn" onclick="connectMetaMask()">
                        <svg width="24" height="24" viewBox="0 0 35 33" xmlns="http://www.w3.org/2000/svg">
                            <g stroke-linecap="round" stroke-linejoin="round" stroke-width="1">
                                <path d="m32.9582 1-13.1341 9.7183 2.4424-5.72731z" fill="#e17726" stroke="#e17726"/>
                                <g fill="#e27625" stroke="#e27625">
                                    <path d="m2.66296 1 13.01714 9.809-2.3254-5.81802z"/>
                                    <path d="m28.2295 23.5335-3.4947 5.3386 7.4829 2.0603 2.1436-7.2823z"/>
                                    <path d="m1.27281 23.6501 2.13055 7.2823 7.46994-2.0603-3.48166-5.3386z"/>
                                    <path d="m10.4706 14.5149-2.0786 3.1358 7.405.3369-.2469-7.969z"/>
                                    <path d="m25.1505 14.5149-5.1575-4.58704-.1688 8.05974 7.4049-.3369z"/>
                                    <path d="m10.8733 28.8721 4.4819-2.1639-3.8583-3.0062z"/>
                                    <path d="m20.2659 26.7082 4.4689 2.1639-.6105-5.1701z"/>
                                </g>
                                <path d="m24.7348 28.8721-4.469-2.1639.3638 2.9025-.039 1.231z" fill="#d5bfb2" stroke="#d5bfb2"/>
                                <path d="m10.8732 28.8721 4.1572 1.9696-.026-1.231.3508-2.9025z" fill="#d5bfb2" stroke="#d5bfb2"/>
                                <path d="m15.1084 21.7842-3.7155-1.0884 2.6243-1.2051z" fill="#233447" stroke="#233447"/>
                                <path d="m20.5126 21.7842 1.0913-2.2935 2.6372 1.2051z" fill="#233447" stroke="#233447"/>
                                <path d="m10.8733 28.8721.6495-5.3386-4.13117.1167z" fill="#cc6228" stroke="#cc6228"/>
                                <path d="m24.0982 23.5335.6366 5.3386 3.4946-5.2219z" fill="#cc6228" stroke="#cc6228"/>
                                <path d="m27.2291 17.6507-7.405.3369.6885 3.7966 1.0913-2.2935 2.6372 1.2051z" fill="#cc6228" stroke="#cc6228"/>
                                <path d="m11.3929 20.6958 2.6242-1.2051 1.0913 2.2935.6885-3.7966-7.40495-.3369z" fill="#cc6228" stroke="#cc6228"/>
                                <path d="m8.392 17.6507 3.1049 6.0513-.1039-3.0062z" fill="#e27525" stroke="#e27525"/>
                                <path d="m24.2412 20.6958-.1169 3.0062 3.1049-6.0513z" fill="#e27525" stroke="#e27525"/>
                                <path d="m15.797 17.9876-.6886 3.7967.8704 4.4833.1949-5.9087z" fill="#e27525" stroke="#e27525"/>
                                <path d="m19.8242 17.9876-.3638 2.3584.1819 5.9216.8704-4.4833z" fill="#e27525" stroke="#e27525"/>
                                <path d="m20.5127 21.7842-.8704 4.4834.6236.4406 3.8584-3.0062.1169-3.0062z" fill="#f5841f" stroke="#f5841f"/>
                                <path d="m11.3929 20.6958.104 3.0062 3.8583 3.0062.6236-.4406-.8704-4.4834z" fill="#f5841f" stroke="#f5841f"/>
                                <path d="m20.5906 30.8417.039-1.231-.3378-.2851h-4.9626l-.3248.2851.026 1.231-4.1572-1.9696 1.4551 1.1921 2.9489 2.0344h5.0536l2.962-2.0344 1.442-1.1921z" fill="#c0ac9d" stroke="#c0ac9d"/>
                                <path d="m20.2659 26.7082-.6236-.4406h-3.6635l-.6236.4406-.3508 2.9025.3248-.2851h4.9626l.3378.2851z" fill="#161616" stroke="#161616"/>
                                <path d="m33.5168 11.3532 1.1043-5.36447-1.6629-4.98873-12.6923 9.3944 4.8846 4.1205 6.8983 2.0085 1.52-1.7752-.6626-.4795 1.0523-.9588-.8054-.622 1.0523-.8034z" fill="#763e1a" stroke="#763e1a"/>
                                <path d="m1 5.98873 1.11724 5.36447-.71451.5313 1.06527.8034-.80545.622 1.05228.9588-.66255.4795 1.51997 1.7752 6.89835-2.0085 4.8846-4.1205-12.69233-9.3944z" fill="#763e1a" stroke="#763e1a"/>
                                <path d="m32.0489 16.5234-6.8983-2.0085 2.0786 3.1358-3.1049 6.0513 4.1052-.0519h6.1318z" fill="#f5841f" stroke="#f5841f"/>
                                <path d="m10.4705 14.5149-6.89828 2.0085-2.29944 7.1267h6.11883l4.10519.0519-3.10487-6.0513z" fill="#f5841f" stroke="#f5841f"/>
                                <path d="m19.8241 17.9876.4417-7.5932 2.0007-5.4034h-8.9119l2.0006 5.4034.4417 7.5932.1689 2.3842.013 5.8958h3.6635l.013-5.8958z" fill="#f5841f" stroke="#f5841f"/>
                            </g>
                        </svg>
                        <span>MetaMask</span>
                    </button>
                    <button class="wallet-connect-btn" onclick="connectWalletConnect()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#3B99FC">
                            <path d="M5.5 9C9 5.5 15 5.5 18.5 9L19.5 10C19.75 10.25 19.75 10.75 19.5 11L16.5 14C16.25 14.25 15.75 14.25 15.5 14L14 12.5C12.5 11 11.5 11 10 12.5L8.5 14C8.25 14.25 7.75 14.25 7.5 14L4.5 11C4.25 10.75 4.25 10.25 4.5 10L5.5 9Z" />
                        </svg>
                        <span>WalletConnect</span>
                    </button>
                    <button class="wallet-connect-btn" onclick="connectBinance()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#F3BA2F">
                            <path d="M12 2L7 7L9 9L12 6L15 9L17 7L12 2Z"/>
                            <path d="M5 9L2 12L5 15L7 13V11L5 9Z"/>
                            <path d="M19 9L17 11V13L19 15L22 12L19 9Z"/>
                            <path d="M12 18L9 15L7 17L12 22L17 17L15 15L12 18Z"/>
                            <rect x="10" y="10" width="4" height="4" fill="#F3BA2F"/>
                        </svg>
                        <span>Binance Wallet</span>
                    </button>
                    <button class="wallet-connect-btn" onclick="connectTrustWallet()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#3375BB">
                            <path d="M12 2C7 2 3 6 3 11C3 16 7 22 12 22C17 22 21 16 21 11C21 6 17 2 12 2ZM12 6C14.5 6 16.5 8 16.5 10.5C16.5 11.5 16 12.5 15.5 13L12 17L8.5 13C8 12.5 7.5 11.5 7.5 10.5C7.5 8 9.5 6 12 6Z"/>
                        </svg>
                        <span>Trust Wallet</span>
                    </button>
                    <button class="wallet-connect-btn" onclick="connectCoinbase()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#0052FF">
                            <circle cx="12" cy="12" r="10" fill="#0052FF"/>
                            <path d="M9 9H15V15H9V9Z" fill="white"/>
                        </svg>
                        <span>Coinbase</span>
                    </button>
                    <button class="wallet-connect-btn" onclick="connectPhantom()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#AB9FF2">
                            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM9 8C9.55 8 10 8.45 10 9C10 9.55 9.55 10 9 10C8.45 10 8 9.55 8 9C8 8.45 8.45 8 9 8ZM15 8C15.55 8 16 8.45 16 9C16 9.55 15.55 10 15 10C14.45 10 14 9.55 14 9C14 8.45 14.45 8 15 8ZM12 18C9 18 6.5 16 6 13H18C17.5 16 15 18 12 18Z"/>
                        </svg>
                        <span>Phantom</span>
                    </button>
                </div>
            </div>
            
            <div style="text-align: center; margin: 20px 0;">
                <span style="color: #666;">— OR —</span>
            </div>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <button class="button button-secondary" onclick="testMetaMask()" style="font-size: 12px; padding: 8px;">
                    Test MetaMask Connection
                </button>
            </div>
            
            <div class="input-group">
                <label class="input-label">Import with 24-Word Seed Phrase</label>
                <div class="seed-phrase-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px;">
                    <input type="text" class="seed-input" placeholder="1" id="seed1" onkeyup="moveToNext(event, 1)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="2" id="seed2" onkeyup="moveToNext(event, 2)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="3" id="seed3" onkeyup="moveToNext(event, 3)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="4" id="seed4" onkeyup="moveToNext(event, 4)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="5" id="seed5" onkeyup="moveToNext(event, 5)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="6" id="seed6" onkeyup="moveToNext(event, 6)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="7" id="seed7" onkeyup="moveToNext(event, 7)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="8" id="seed8" onkeyup="moveToNext(event, 8)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="9" id="seed9" onkeyup="moveToNext(event, 9)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="10" id="seed10" onkeyup="moveToNext(event, 10)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="11" id="seed11" onkeyup="moveToNext(event, 11)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="12" id="seed12" onkeyup="moveToNext(event, 12)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="13" id="seed13" onkeyup="moveToNext(event, 13)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="14" id="seed14" onkeyup="moveToNext(event, 14)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="15" id="seed15" onkeyup="moveToNext(event, 15)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="16" id="seed16" onkeyup="moveToNext(event, 16)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="17" id="seed17" onkeyup="moveToNext(event, 17)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="18" id="seed18" onkeyup="moveToNext(event, 18)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="19" id="seed19" onkeyup="moveToNext(event, 19)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="20" id="seed20" onkeyup="moveToNext(event, 20)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="21" id="seed21" onkeyup="moveToNext(event, 21)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="22" id="seed22" onkeyup="moveToNext(event, 22)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="23" id="seed23" onkeyup="moveToNext(event, 23)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                    <input type="text" class="seed-input" placeholder="24" id="seed24" onkeyup="moveToNext(event, 24)" style="padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.05); color: white; text-align: center;">
                </div>
                <button class="button button-secondary" onclick="pasteSeedPhrase()" style="margin-bottom: 15px;">
                    <span>📋</span>
                    <span>Paste from Clipboard</span>
                </button>
            </div>
            
            <div class="input-group">
                <label class="input-label">New Password for QRC Wallet</label>
                <input type="password" class="input-field" id="importPassword" placeholder="Create password for this device">
            </div>
            
            <button class="button button-primary" onclick="importExistingWallet()">
                <span>📥</span>
                <span>Import with Seed Phrase</span>
            </button>
            
            <button class="button button-secondary" onclick="backToLogin()">
                <span>←</span>
                <span>Back to Login</span>
            </button>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer">
        <header class="main-header">
            <div class="logo-section">
                <div class="logo">QRC</div>
                <div class="logo-text">Quantum Wallet</div>
            </div>
            <nav class="nav-links">
                <a href="#" class="nav-link" onclick="showExplorer(); return false;">Explorer</a>
                <a href="#" class="nav-link" onclick="showBridge(); return false;">Bridge</a>
                <a href="#" class="nav-link" onclick="showGovernance(); return false;">Governance</a>
                <a href="#" class="nav-link" onclick="showDocs(); return false;">Docs</a>
            </nav>
            <div class="user-menu">
                <div class="network-indicator">
                    <div class="network-dot"></div>
                    <span>Mainnet</span>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span id="userDisplay">User</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </header>

        <div class="main-content">
            <div class="stats-section">
                <div class="stat-card">
                    <div class="stat-value" id="currentTPS">0</div>
                    <div class="stat-label">Current TPS</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalBlocks">0</div>
                    <div class="stat-label">Total Blocks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalTransactions">0</div>
                    <div class="stat-label">Transactions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="activeUsers">0</div>
                    <div class="stat-label">Active Users</div>
                </div>
            </div>

            <div class="wallet-section">
                <div class="wallet-header">
                    <h2 class="wallet-title">Quantum Resistant Wallet</h2>
                    <div class="wallet-menu">
                        <button class="menu-button" onclick="showSettings()">⚙️</button>
                        <button class="menu-button" onclick="showHelp()">❓</button>
                    </div>
                </div>

                <div class="security-status">
                    <span class="security-icon">🔒</span>
                    <span>Secured with password + encryption</span>
                </div>

                <div class="algorithm-badge">
                    <div class="badge-icon">✓</div>
                    <span>Protected by CRYSTALS-Dilithium</span>
                </div>

                <div class="wallet-display">
                    <div class="wallet-label">Your Wallet Address</div>
                    <div class="wallet-address-container">
                        <div class="wallet-address" id="walletAddress" onclick="copyAddress()"></div>
                        <div class="address-actions">
                            <button class="menu-button" onclick="showQRModal()" title="Show QR Code">📱</button>
                            <button class="menu-button" onclick="copyAddress()" title="Copy Address">📋</button>
                        </div>
                    </div>
                </div>

                <div class="balance-display">
                    <div class="balance-label">Total Balance</div>
                    <div class="balance-amount" id="balanceAmount">0.00 QRC</div>
                    <div class="balance-usd" id="balanceUSD">≈ $0.00 USD</div>
                </div>

                <div class="tabs">
                    <div class="tab active" onclick="showTab('wallet', this)">Wallet</div>
                    <div class="tab" onclick="showTab('activity', this)">Activity</div>
                    <div class="tab" onclick="showTab('security', this)">Security</div>
                </div>

                <div id="walletTab" class="tab-content active">
                    <button class="button button-primary" onclick="showSendModal()">
                        <span>📤</span>
                        <span>Send QRC</span>
                    </button>
                    <button class="button button-secondary" onclick="showReceiveModal()">
                        <span>📥</span>
                        <span>Receive</span>
                    </button>
                    <button class="button button-secondary" onclick="getFaucet()">
                        <span>💧</span>
                        <span>Test Faucet (100 QRC daily)</span>
                    </button>
                </div>

                <div id="activityTab" class="tab-content">
                    <div id="transactionHistory">
                        <div class="empty-state">
                            <div class="empty-state-icon">📊</div>
                            <p>No transactions yet</p>
                            <p style="font-size: 14px; margin-top: 10px;">Your transaction history will appear here</p>
                        </div>
                    </div>
                </div>

                <div id="securityTab" class="tab-content">
                    <div style="background: rgba(255, 107, 107, 0.1); border: 1px solid #ff6b6b; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin-bottom: 10px;">⚠️ Security Information</h4>
                        <p style="font-size: 14px; line-height: 1.6;">Your wallet is encrypted with your password. Never share your seed phrase or password with anyone.</p>
                    </div>
                    <button class="button button-secondary" onclick="showSeedPhrase()">
                        <span>📝</span>
                        <span>View Seed Phrase</span>
                    </button>
                    <button class="button button-secondary" onclick="changePassword()">
                        <span>🔑</span>
                        <span>Change Password</span>
                    </button>
                    <button class="button button-secondary" onclick="exportWallet()">
                        <span>💾</span>
                        <span>Export Encrypted Backup</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="sendModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Send QRC</h2>
                <button class="close-modal" onclick="closeModal('sendModal')">×</button>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #999; font-size: 14px;">Recipient Address</label>
                <input type="text" id="recipientAddress" placeholder="QRC..." style="width: 100%; padding: 15px; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #999; font-size: 14px;">Amount (QRC)</label>
                <input type="number" id="sendAmount" placeholder="0.00" step="0.01" oninput="updateFeeDisplay()" style="width: 100%; padding: 15px; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;">
            </div>
            
            <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Network Fee:</span>
                    <span id="feeDisplay">0.00 QRC</span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: 600;">
                    <span>Total:</span>
                    <span id="totalDisplay">0.00 QRC</span>
                </div>
            </div>

            <button class="button button-primary" onclick="confirmSend()">
                Sign & Send Transaction
            </button>
        </div>
    </div>

    <div class="modal" id="receiveModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Receive QRC</h2>
                <button class="close-modal" onclick="closeModal('receiveModal')">×</button>
            </div>
            
            <div class="qr-container">
                <h3 class="qr-title">Your QRC Address</h3>
                <div id="receiveQrcode"></div>
                <div class="qr-address" id="receiveAddress"></div>
                <button class="button button-secondary" onclick="copyAddress()">Copy Address</button>
            </div>
        </div>
    </div>

    <div class="modal" id="qrModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">QR Code</h2>
                <button class="close-modal" onclick="closeModal('qrModal')">×</button>
            </div>
            
            <div class="qr-container">
                <h3 class="qr-title">Scan to Send QRC</h3>
                <div id="qrcode"></div>
                <div class="qr-address" id="qrAddress"></div>
                <button class="button button-secondary" onclick="copyAddress()">Copy Address</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Global state
        let walletState = {
            address: null,
            seedPhrase: null,
            balance: 0,
            encryptedData: null,
            isLoggedIn: false,
            transactions: []
        };
        
        let sessionPassword = null;
        let qrcode = null;
        let receiveQrcode = null;
        let activityInterval = null;
        let balanceInterval = null;

        // Utility functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification ' + type;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        function togglePassword() {
            const input = document.getElementById('walletPassword');
            input.type = input.type === 'password' ? 'text' : 'password';
        }

        function showError(message) {
            document.getElementById('loginError').textContent = message;
            document.getElementById('loginError').style.display = 'block';
            setTimeout(() => {
                document.getElementById('loginError').style.display = 'none';
            }, 5000);
        }

        function showSuccess(message) {
            document.getElementById('loginSuccess').textContent = message;
            document.getElementById('loginSuccess').style.display = 'block';
            setTimeout(() => {
                document.getElementById('loginSuccess').style.display = 'none';
            }, 5000);
        }

        // Login functions
        function attemptLogin() {
            const password = document.getElementById('walletPassword').value;
            
            if (!password) {
                showError('Please enter your password');
                return;
            }
            
            const encryptedWallet = localStorage.getItem('qrcWalletEncrypted');
            if (!encryptedWallet) {
                showError('No wallet found. Please create a new wallet.');
                return;
            }
            
            try {
                // Decrypt wallet data
                const decrypted = CryptoJS.AES.decrypt(encryptedWallet, password);
                const decryptedStr = decrypted.toString(CryptoJS.enc.Utf8);
                
                if (!decryptedStr) {
                    showError('Invalid password');
                    return;
                }
                
                walletState = JSON.parse(decryptedStr);
                walletState.isLoggedIn = true;
                sessionPassword = password;
                
                // Show main app
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('appContainer').style.display = 'block';
                
                // Initialize app
                initializeApp();
                showNotification('Welcome back! Wallet unlocked successfully', 'success');
                
            } catch (error) {
                showError('Invalid password or corrupted wallet data');
            }
        }

        function showCreateNewWallet() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('createWalletForm').style.display = 'block';
        }

        function showImportWallet() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('importWalletForm').style.display = 'block';
        }

        function backToLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('createWalletForm').style.display = 'none';
            document.getElementById('importWalletForm').style.display = 'none';
        }

        function createNewWallet() {
            const password = document.getElementById('newPassword').value;
            const confirmPass = document.getElementById('confirmPassword').value;
            
            if (password.length < 8) {
                showError('Password must be at least 8 characters');
                return;
            }
            
            if (password !== confirmPass) {
                showError('Passwords do not match');
                return;
            }
            
            // Generate seed phrase
            const seedPhrase = generateSeedPhrase();
            
            // Create wallet on server
            fetch('/api/wallet/create', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    walletState = {
                        address: data.address,
                        seedPhrase: seedPhrase,
                        balance: data.balance,
                        transactions: [],
                        created: Date.now()
                    };
                    
                    // Encrypt and save
                    const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
                    localStorage.setItem('qrcWalletEncrypted', encrypted);
                    
                    showSuccess('Wallet created successfully! Please login.');
                    setTimeout(() => {
                        backToLogin();
                        document.getElementById('newPassword').value = '';
                        document.getElementById('confirmPassword').value = '';
                    }, 2000);
                } else {
                    showError('Failed to create wallet. Please try again.');
                }
            })
            .catch(error => {
                // Create wallet locally if server is down
                walletState = {
                    address: 'QRC' + generateRandomString(32),
                    seedPhrase: seedPhrase,
                    balance: 1000,
                    transactions: [],
                    created: Date.now()
                };
                
                const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
                localStorage.setItem('qrcWalletEncrypted', encrypted);
                
                showSuccess('Wallet created locally! Please login.');
                setTimeout(backToLogin, 2000);
            });
        }

        function importExistingWallet() {
            // Collect seed phrase from individual inputs
            const seedWords = [];
            for (let i = 1; i <= 24; i++) {
                const word = document.getElementById(`seed${i}`).value.trim().toLowerCase();
                if (!word) {
                    showError(`Please enter word ${i} of your seed phrase`);
                    document.getElementById(`seed${i}`).focus();
                    return;
                }
                seedWords.push(word);
            }
            
            const seedPhrase = seedWords.join(' ');
            const password = document.getElementById('importPassword').value;
            
            if (password.length < 8) {
                showError('Password must be at least 8 characters');
                return;
            }
            
            // Import wallet
            walletState = {
                address: 'QRC' + generateAddressFromSeed(seedPhrase),
                seedPhrase: seedWords,
                balance: 0,
                transactions: [],
                imported: Date.now()
            };
            
            // Encrypt and save
            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
            localStorage.setItem('qrcWalletEncrypted', encrypted);
            
            showSuccess('Wallet imported successfully! Please login.');
            setTimeout(() => {
                backToLogin();
                // Clear all seed inputs
                for (let i = 1; i <= 24; i++) {
                    document.getElementById(`seed${i}`).value = '';
                }
                document.getElementById('importPassword').value = '';
            }, 2000);
        }
        
        // Helper functions for seed phrase input
        function moveToNext(event, currentIndex) {
            const input = event.target;
            
            // Move to next on space or when word looks complete
            if (event.key === ' ' || (input.value.length > 2 && event.key !== 'Backspace')) {
                if (currentIndex < 24) {
                    document.getElementById(`seed${currentIndex + 1}`).focus();
                }
            }
            
            // Move to previous on backspace when empty
            if (event.key === 'Backspace' && input.value === '' && currentIndex > 1) {
                document.getElementById(`seed${currentIndex - 1}`).focus();
            }
        }
        
        async function pasteSeedPhrase() {
            try {
                const text = await navigator.clipboard.readText();
                const words = text.trim().split(/\s+/);
                
                if (words.length !== 24) {
                    showError('Clipboard must contain exactly 24 words');
                    return;
                }
                
                // Fill in the seed phrase inputs
                words.forEach((word, index) => {
                    const input = document.getElementById(`seed${index + 1}`);
                    if (input) {
                        input.value = word.toLowerCase();
                    }
                });
                
                showNotification('Seed phrase pasted successfully', 'success');
            } catch (error) {
                showError('Failed to read clipboard. Please paste manually.');
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                walletState = {
                    address: null,
                    seedPhrase: null,
                    balance: 0,
                    isLoggedIn: false,
                    transactions: []
                };
                sessionPassword = null;
                
                // Clear intervals
                if (activityInterval) clearInterval(activityInterval);
                if (balanceInterval) clearInterval(balanceInterval);
                
                // Show login screen
                document.getElementById('appContainer').style.display = 'none';
                document.getElementById('loginScreen').style.display = 'block';
                document.getElementById('walletPassword').value = '';
                
                showNotification('Logged out successfully', 'info');
            }
        }

        // App initialization
        function initializeApp() {
            // Update UI with wallet info
            document.getElementById('walletAddress').textContent = walletState.address;
            document.getElementById('userAvatar').textContent = walletState.address.substring(3, 4).toUpperCase();
            document.getElementById('userDisplay').textContent = walletState.address.substring(0, 8) + '...';
            
            // Update balance
            updateBalanceDisplay();
            
            // Start real-time updates
            startRealtimeUpdates();
            
            // Load initial data
            updateStats();
            loadTransactionHistory();
        }

        function startRealtimeUpdates() {
            // Update balance every 5 seconds
            balanceInterval = setInterval(() => {
                updateBalance();
            }, 5000);
            
            // Update activity every 3 seconds
            activityInterval = setInterval(() => {
                if (document.getElementById('activityTab').classList.contains('active')) {
                    loadTransactionHistory();
                }
                updateStats();
            }, 3000);
        }

        // Wallet functions
        function generateSeedPhrase() {
            const wordList = ['abandon', 'ability', 'able', 'about', 'above', 'absent', 'absorb', 'abstract', 'absurd', 'abuse', 
                             'access', 'accident', 'account', 'accuse', 'achieve', 'acid', 'acoustic', 'acquire', 'across', 'act',
                             'action', 'actor', 'actress', 'actual', 'adapt', 'add', 'addict', 'address', 'adjust', 'admit',
                             'adult', 'advance', 'advice', 'aerobic', 'affair', 'afford', 'afraid', 'again', 'age', 'agent'];
            
            const phrase = [];
            for (let i = 0; i < 24; i++) {
                phrase.push(wordList[Math.floor(Math.random() * wordList.length)]);
            }
            return phrase;
        }

        function generateRandomString(length) {
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateAddressFromSeed(seed) {
            // Simple hash of seed for demo
            let hash = 0;
            for (let i = 0; i < seed.length; i++) {
                hash = ((hash << 5) - hash) + seed.charCodeAt(i);
                hash = hash & hash;
            }
            return Math.abs(hash).toString(36).toUpperCase().padEnd(32, '0').substring(0, 32);
        }

        function updateBalanceDisplay() {
            document.getElementById('balanceAmount').textContent = `${walletState.balance.toFixed(2)} QRC`;
            document.getElementById('balanceUSD').textContent = `≈ $${(walletState.balance * 0.001).toFixed(2)} USD`;
        }

        function updateBalance() {
            if (!walletState.address) return;
            
            fetch(`/api/wallet/balance/${walletState.address}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        walletState.balance = data.balance;
                        updateBalanceDisplay();
                        
                        // Save updated balance
                        if (sessionPassword) {
                            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), sessionPassword).toString();
                            localStorage.setItem('qrcWalletEncrypted', encrypted);
                        }
                    }
                })
                .catch(error => {
                    console.error('Error updating balance:', error);
                });
        }

        function updateStats() {
            fetch('/api/stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('currentTPS').textContent = data.current_tps || 0;
                    document.getElementById('totalBlocks').textContent = data.block_height || 0;
                    document.getElementById('totalTransactions').textContent = data.total_transactions || 0;
                    document.getElementById('activeUsers').textContent = data.active_users || 0;
                })
                .catch(error => console.error('Error updating stats:', error));
        }

        function showTab(tabName, element) {
            // Update tab styles
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            element.classList.add('active');
            
            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Load data if needed
            if (tabName === 'activity') {
                loadTransactionHistory();
            }
        }

        function loadTransactionHistory() {
            fetch('/api/transactions/recent')
                .then(response => response.json())
                .then(data => {
                    const historyDiv = document.getElementById('transactionHistory');
                    
                    if (data.success && data.transactions && data.transactions.length > 0) {
                        // Filter transactions for this wallet
                        const myTransactions = data.transactions.filter(tx => 
                            tx.sender === walletState.address || tx.recipient === walletState.address
                        );
                        
                        if (myTransactions.length === 0) {
                            historyDiv.innerHTML = `
                                <div class="empty-state">
                                    <div class="empty-state-icon">📊</div>
                                    <p>No transactions yet</p>
                                    <p style="font-size: 14px; margin-top: 10px;">Send or receive QRC to see activity</p>
                                </div>
                            `;
                            return;
                        }
                        
                        // Store transactions
                        walletState.transactions = myTransactions;
                        
                        // Build transaction HTML
                        let html = '';
                        myTransactions.slice(0, 20).forEach(tx => {
                            const isIncoming = tx.recipient === walletState.address;
                            const time = new Date(tx.timestamp * 1000);
                            
                            html += `
                                <div class="transaction-item">
                                    <div style="display: flex; align-items: center; flex: 1;">
                                        <div class="transaction-icon ${isIncoming ? 'received' : 'sent'}">
                                            ${isIncoming ? '↓' : '↑'}
                                        </div>
                                        <div class="transaction-details">
                                            <div class="transaction-type">${isIncoming ? 'Received' : 'Sent'}</div>
                                            <div class="transaction-address">
                                                ${isIncoming ? 'From: ' + tx.sender.substring(0, 16) + '...' : 'To: ' + tx.recipient.substring(0, 16) + '...'}
                                            </div>
                                            <div class="transaction-time">${formatTime(time)}</div>
                                        </div>
                                    </div>
                                    <div class="transaction-amount">
                                        <div class="transaction-value ${isIncoming ? 'positive' : 'negative'}">
                                            ${isIncoming ? '+' : '-'}${tx.amount} QRC
                                        </div>
                                        <div class="transaction-usd">≈ $${(tx.amount * 0.001).toFixed(2)}</div>
                                    </div>
                                </div>
                            `;
                        });
                        
                        historyDiv.innerHTML = html;
                    } else {
                        historyDiv.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-state-icon">📊</div>
                                <p>No transactions yet</p>
                                <p style="font-size: 14px; margin-top: 10px;">Your transaction history will appear here</p>
                            </div>
                        `;
                    }
                })
                .catch(error => {
                    console.error('Error loading transactions:', error);
                });
        }

        function formatTime(date) {
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return Math.floor(diff / 60000) + ' min ago';
            if (diff < 86400000) return Math.floor(diff / 3600000) + ' hours ago';
            
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
        }

        // Faucet function
        function getFaucet() {
            const lastClaim = localStorage.getItem(`lastFaucetClaim_${walletState.address}`);
            const now = Date.now();
            
            if (lastClaim && now - parseInt(lastClaim) < 24 * 60 * 60 * 1000) {
                const hoursLeft = Math.ceil((24 * 60 * 60 * 1000 - (now - parseInt(lastClaim))) / (60 * 60 * 1000));
                showNotification(`You can claim again in ${hoursLeft} hours`, 'warning');
                return;
            }
            
            // Send faucet request
            fetch('/api/faucet/claim', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    address: walletState.address
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    localStorage.setItem(`lastFaucetClaim_${walletState.address}`, now.toString());
                    walletState.balance = data.new_balance;
                    updateBalanceDisplay();
                    showNotification('100 Test QRC received!', 'success');
                    
                    // Save updated balance
                    if (sessionPassword) {
                        const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), sessionPassword).toString();
                        localStorage.setItem('qrcWalletEncrypted', encrypted);
                    }
                    
                    // Reload transactions
                    setTimeout(() => loadTransactionHistory(), 1000);
                } else {
                    showNotification(data.error || 'Faucet claim failed', 'error');
                }
            })
            .catch(error => {
                // Fallback for offline mode
                localStorage.setItem(`lastFaucetClaim_${walletState.address}`, now.toString());
                walletState.balance += 100;
                updateBalanceDisplay();
                showNotification('100 Test QRC added (offline mode)', 'success');
            });
        }

        // Send transaction
        function showSendModal() {
            document.getElementById('sendModal').style.display = 'flex';
            updateFeeDisplay();
        }

        function updateFeeDisplay() {
            const amount = parseFloat(document.getElementById('sendAmount').value) || 0;
            const fee = Math.max(amount * 0.002, 0.01);
            document.getElementById('feeDisplay').textContent = fee.toFixed(2) + ' QRC';
            document.getElementById('totalDisplay').textContent = (amount + fee).toFixed(2) + ' QRC';
        }

        function confirmSend() {
            const recipient = document.getElementById('recipientAddress').value;
            const amount = parseFloat(document.getElementById('sendAmount').value);
            
            if (!recipient || !amount) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            if (!recipient.startsWith('QRC')) {
                showNotification('Invalid address format', 'error');
                return;
            }
            
            const fee = Math.max(amount * 0.002, 0.01);
            const total = amount + fee;
            
            if (total > walletState.balance) {
                showNotification('Insufficient balance', 'error');
                return;
            }
            
            // Send transaction
            fetch('/api/transaction/send', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    sender: walletState.address,
                    recipient: recipient,
                    amount: amount,
                    algorithm: 'CRYSTALS-Dilithium-2'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Transaction sent successfully!', 'success');
                    closeModal('sendModal');
                    
                    // Clear form
                    document.getElementById('recipientAddress').value = '';
                    document.getElementById('sendAmount').value = '';
                    
                    // Update balance
                    setTimeout(() => {
                        updateBalance();
                        loadTransactionHistory();
                    }, 1000);
                } else {
                    showNotification(data.error || 'Transaction failed', 'error');
                }
            })
            .catch(error => {
                showNotification('Network error. Please try again.', 'error');
            });
        }

        // Receive functions
        function showReceiveModal() {
            const modal = document.getElementById('receiveModal');
            modal.style.display = 'flex';
            
            // Generate QR code
            if (receiveQrcode) {
                document.getElementById('receiveQrcode').innerHTML = '';
            }
            
            receiveQrcode = new QRCode(document.getElementById('receiveQrcode'), {
                text: walletState.address,
                width: 200,
                height: 200,
                colorDark: '#000000',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H
            });
            
            document.getElementById('receiveAddress').textContent = walletState.address;
        }

        function showQRModal() {
            const modal = document.getElementById('qrModal');
            modal.style.display = 'flex';
            
            if (qrcode) {
                document.getElementById('qrcode').innerHTML = '';
            }
            
            qrcode = new QRCode(document.getElementById('qrcode'), {
                text: walletState.address,
                width: 200,
                height: 200,
                colorDark: '#000000',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H
            });
            
            document.getElementById('qrAddress').textContent = walletState.address;
        }

        function copyAddress() {
            navigator.clipboard.writeText(walletState.address);
            showNotification('Address copied to clipboard!', 'success');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Security functions
        function showSeedPhrase() {
            const password = prompt('Enter your password to view seed phrase:');
            if (!password) return;
            
            if (password !== sessionPassword) {
                showNotification('Invalid password', 'error');
                return;
            }
            
            alert('Your 24-word seed phrase:\n\n' + walletState.seedPhrase.join(' ') + '\n\nWrite this down and keep it safe!');
        }

        function changePassword() {
            const oldPassword = prompt('Enter current password:');
            if (!oldPassword || oldPassword !== sessionPassword) {
                showNotification('Invalid password', 'error');
                return;
            }
            
            const newPassword = prompt('Enter new password (min 8 characters):');
            if (!newPassword || newPassword.length < 8) {
                showNotification('Password must be at least 8 characters', 'error');
                return;
            }
            
            const confirmPassword = prompt('Confirm new password:');
            if (newPassword !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }
            
            // Re-encrypt with new password
            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), newPassword).toString();
            localStorage.setItem('qrcWalletEncrypted', encrypted);
            sessionPassword = newPassword;
            
            showNotification('Password changed successfully!', 'success');
        }

        function exportWallet() {
            const password = prompt('Enter your password to export wallet:');
            if (!password || password !== sessionPassword) {
                showNotification('Invalid password', 'error');
                return;
            }
            
            const exportData = {
                type: 'QRC_WALLET_BACKUP',
                version: '1.0',
                encrypted: localStorage.getItem('qrcWalletEncrypted'),
                timestamp: Date.now()
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', `qrc-wallet-backup-${Date.now()}.json`);
            linkElement.click();
            
            showNotification('Wallet backup exported!', 'success');
        }

        // Navigation functions
        function showExplorer() {
            window.open('/explorer', '_blank');
        }

        function showBridge() {
            showNotification('Bridge feature coming soon!', 'info');
        }

        function showGovernance() {
            showNotification('Governance feature coming soon!', 'info');
        }

        function showDocs() {
            window.open('https://github.com/PQC-Blockchain', '_blank');
        }

        function showSettings() {
            showNotification('Settings coming soon!', 'info');
        }

        function showHelp() {
            alert('QRC Wallet Help\n\n' +
                  '• Your wallet is encrypted with your password\n' +
                  '• Never share your seed phrase or password\n' +
                  '• Transactions are quantum-resistant\n' +
                  '• Contact: support@qrcblockchain.com');
        }

        // Test function for MetaMask
        function testMetaMask() {
            const report = [];
            report.push('=== MetaMask Connection Test ===');
            report.push(`URL: ${window.location.href}`);
            report.push(`Protocol: ${window.location.protocol}`);
            report.push(`window.ethereum exists: ${!!window.ethereum}`);
            
            if (window.ethereum) {
                report.push(`ethereum.isMetaMask: ${window.ethereum.isMetaMask}`);
                report.push(`ethereum.selectedAddress: ${window.ethereum.selectedAddress}`);
                report.push(`ethereum.chainId: ${window.ethereum.chainId}`);
                report.push(`Multiple providers: ${!!(window.ethereum.providers)}`);
                
                if (window.ethereum.providers) {
                    report.push(`Number of providers: ${window.ethereum.providers.length}`);
                }
            }
            
            console.log(report.join('\n'));
            alert(report.join('\n'));
        }
        
        // Wallet Integration Functions
        async function connectMetaMask() {
            // Debug information
            console.log('MetaMask connection attempt...');
            console.log('window.ethereum:', window.ethereum);
            console.log('ethereum.isMetaMask:', window.ethereum?.isMetaMask);
            
            // First, let's check if we're on localhost or file://
            const isLocalhost = window.location.hostname === 'localhost' || 
                               window.location.hostname === '127.0.0.1' ||
                               window.location.protocol === 'file:';
            
            if (isLocalhost) {
                alert('MetaMask may not work properly on localhost or file://. Try deploying to a server or using a local HTTPS server.');
            }
            
            // Check if ethereum object exists
            if (typeof window.ethereum === 'undefined') {
                alert('MetaMask is not detected. Please make sure:\n\n1. MetaMask extension is installed\n2. It\'s enabled in Chrome\n3. Try refreshing the page');
                return;
            }
            
            try {
                // Force MetaMask to be the selected wallet if multiple wallets installed
                if (window.ethereum.providers?.length) {
                    const metamaskProvider = window.ethereum.providers.find((p) => p.isMetaMask);
                    if (metamaskProvider) {
                        window.ethereum = metamaskProvider;
                    }
                }
                
                console.log('Requesting accounts...');
                
                // This is the standard way to connect
                const accounts = await window.ethereum.request({ 
                    method: 'eth_requestAccounts' 
                });
                
                console.log('Accounts received:', accounts);
                
                if (accounts && accounts.length > 0) {
                    const address = accounts[0];
                    showNotification(`MetaMask connected! Address: ${address.substring(0, 10)}...`, 'success');
                    
                    // Ask for password
                    setTimeout(() => {
                        const password = prompt('Create a password for your QRC wallet (min 8 characters):');
                        if (!password || password.length < 8) {
                            showNotification('Password must be at least 8 characters', 'error');
                            return;
                        }
                        
                        const confirmPassword = prompt('Confirm your password:');
                        if (password !== confirmPassword) {
                            showNotification('Passwords do not match', 'error');
                            return;
                        }
                        
                        // Generate QRC address
                        const qrcAddress = 'QRC' + generateAddressFromSeed(address + 'MetaMask');
                        
                        // Create wallet state
                        walletState = {
                            address: qrcAddress,
                            externalAddress: address,
                            walletType: 'MetaMask',
                            seedPhrase: ['imported', 'from', 'MetaMask', '...'],
                            balance: 0,
                            transactions: [],
                            imported: Date.now()
                        };
                        
                        // Encrypt and save
                        const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
                        localStorage.setItem('qrcWalletEncrypted', encrypted);
                        
                        showSuccess('MetaMask wallet imported successfully! Please login.');
                        setTimeout(() => {
                            backToLogin();
                        }, 2000);
                    }, 100);
                } else {
                    alert('No accounts found. Please check MetaMask.');
                }
            } catch (error) {
                console.error('MetaMask Error Details:', error);
                
                if (error.code === 4001) {
                    showNotification('You cancelled the connection', 'warning');
                } else if (error.code === -32002) {
                    alert('MetaMask is locked or has a pending request.\n\nPlease:\n1. Open MetaMask extension\n2. Unlock it with your password\n3. Check for any pending connection requests\n4. Try again');
                } else {
                    alert(`MetaMask Error: ${error.message || 'Unknown error'}\n\nTry:\n1. Refreshing the page\n2. Disconnecting other sites in MetaMask\n3. Restarting Chrome`);
                }
            }
        }
        
        async function connectWalletConnect() {
            showNotification('Initializing WalletConnect...', 'info');
            
            // Load WalletConnect dynamically
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js';
            script.onload = async () => {
                try {
                    const WalletConnectProvider = window.WalletConnectProvider.default;
                    const provider = new WalletConnectProvider({
                        infuraId: "your-infura-id", // Replace with your Infura ID
                        qrcode: true,
                        bridge: "https://bridge.walletconnect.org"
                    });
                    
                    // Enable session
                    await provider.enable();
                    
                    const accounts = provider.accounts;
                    if (accounts.length > 0) {
                        showNotification('WalletConnect connected!', 'success');
                        importFromExternalWallet('WalletConnect', accounts[0], null);
                    }
                } catch (error) {
                    showNotification('WalletConnect connection failed', 'error');
                }
            };
            document.head.appendChild(script);
        }
        
        async function connectBinance() {
            if (typeof window.BinanceChain === 'undefined') {
                showNotification('Binance Wallet is not installed', 'error');
                window.open('https://www.binance.com/en/wallet-direct', '_blank');
                return;
            }
            
            try {
                showNotification('Requesting Binance Wallet connection...', 'info');
                const accounts = await window.BinanceChain.request({ 
                    method: 'eth_requestAccounts' 
                });
                
                if (accounts.length > 0) {
                    showNotification('Binance Wallet connected!', 'success');
                    importFromExternalWallet('Binance', accounts[0], null);
                }
            } catch (error) {
                showNotification('Failed to connect Binance Wallet', 'error');
            }
        }
        
        async function connectTrustWallet() {
            // Trust Wallet uses the same interface as MetaMask on mobile
            if (window.ethereum && window.ethereum.isTrust) {
                try {
                    const accounts = await window.ethereum.request({ 
                        method: 'eth_requestAccounts' 
                    });
                    
                    if (accounts.length > 0) {
                        showNotification('Trust Wallet connected!', 'success');
                        importFromExternalWallet('Trust', accounts[0], null);
                    }
                } catch (error) {
                    showNotification('Failed to connect Trust Wallet', 'error');
                }
            } else {
                showNotification('Trust Wallet is not available. Use Trust Wallet mobile app.', 'info');
                window.open('https://trustwallet.com/', '_blank');
            }
        }
        
        async function connectCoinbase() {
            if (typeof window.ethereum === 'undefined' || !window.ethereum.isCoinbaseWallet) {
                showNotification('Coinbase Wallet is not installed', 'error');
                window.open('https://www.coinbase.com/wallet', '_blank');
                return;
            }
            
            try {
                const accounts = await window.ethereum.request({ 
                    method: 'eth_requestAccounts' 
                });
                
                if (accounts.length > 0) {
                    showNotification('Coinbase Wallet connected!', 'success');
                    importFromExternalWallet('Coinbase', accounts[0], null);
                }
            } catch (error) {
                showNotification('Failed to connect Coinbase Wallet', 'error');
            }
        }
        
        async function connectPhantom() {
            if (!window.solana || !window.solana.isPhantom) {
                showNotification('Phantom Wallet is not installed', 'error');
                window.open('https://phantom.app/', '_blank');
                return;
            }
            
            try {
                const response = await window.solana.connect();
                const address = response.publicKey.toString();
                showNotification('Phantom Wallet connected!', 'success');
                importFromExternalWallet('Phantom', address, null);
            } catch (error) {
                showNotification('Failed to connect Phantom Wallet', 'error');
            }
        }
        
        function importFromExternalWallet(walletType, externalAddress, signature) {
            // Ask for password to secure the QRC wallet
            const password = prompt('Create a password for your QRC wallet (min 8 characters):');
            if (!password || password.length < 8) {
                showNotification('Password must be at least 8 characters', 'error');
                return;
            }
            
            const confirmPassword = prompt('Confirm your password:');
            if (password !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }
            
            // Generate QRC address from external address
            const qrcAddress = 'QRC' + generateAddressFromSeed(externalAddress + walletType);
            
            // Create wallet state
            walletState = {
                address: qrcAddress,
                externalAddress: externalAddress,
                walletType: walletType,
                seedPhrase: ['imported', 'from', walletType, '...'], // Placeholder
                balance: 0,
                transactions: [],
                imported: Date.now(),
                signature: signature
            };
            
            // Encrypt and save
            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
            localStorage.setItem('qrcWalletEncrypted', encrypted);
            
            // Register on server
            fetch('/api/wallet/import', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    address: qrcAddress,
                    externalAddress: externalAddress,
                    walletType: walletType,
                    signature: signature
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showSuccess(`${walletType} wallet imported successfully! Please login.`);
                    setTimeout(() => {
                        backToLogin();
                    }, 2000);
                }
            })
            .catch(error => {
                // Still save locally if server is down
                showSuccess(`${walletType} wallet imported locally! Please login.`);
                setTimeout(backToLogin, 2000);
            });
        }
        
        // Check for existing session on load
        window.onload = function() {
            // Clear any auto-login for security
            document.getElementById('walletPassword').value = '';
            
            // Check if wallet exists
            const hasWallet = localStorage.getItem('qrcWalletEncrypted');
            if (!hasWallet) {
                showNotification('Welcome! Create a new wallet to get started.', 'info');
            }
        };
    </script>
</body>
</html>